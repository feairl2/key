<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>老倍遊戲 Key System</title>

<style>
    body {
        margin: 0;
        padding: 0;
        background: #0a0a0a;
        color: #e0e0e0;
        font-family: "Segoe UI", Arial, sans-serif;
        text-align: center;
    }
    h1 {
        margin-top: 60px;
        font-size: 40px;
        color: #8b5dff;
        text-shadow: 0 0 10px #8b5dff;
    }
    #content {
        margin-top: 40px;
        font-size: 20px;
    }
    .btn {
        padding: 14px 32px;
        background: linear-gradient(135deg, #6c47ff, #9b7cff);
        border: none;
        border-radius: 10px;
        font-size: 20px;
        color: #fff;
        cursor: pointer;
        transition: 0.22s;
        box-shadow: 0 0 12px #6c47ff88;
    }
    .btn:hover {
        transform: scale(1.07);
        box-shadow: 0 0 18px #9b7cffcc;
    }
    .keybox {
        margin-top: 20px;
        font-size: 28px;
        padding: 12px 22px;
        background: #111;
        border-radius: 8px;
        display: inline-block;
        color: #40ff9c;
        box-shadow: 0 0 12px #40ff9c66;
    }
</style>
</head>

<body>

<h1>老倍遊戲 Key System</h1>
<div id="content">載入中...</div>

<script>
// --------------------------------
// 永不會壞的 localStorage STEP 系統
// --------------------------------

function getStep(){
    return Number(localStorage.getItem("laobei_step") || "1");
}

function setStep(n){
    localStorage.setItem("laobei_step", String(n));
}

function saveKey(key){
    localStorage.setItem("laobei_key", key);
}

function getKey(){
    return localStorage.getItem("laobei_key");
}

function loadPage(){

    let key = getKey();
    if (key){
        document.getElementById("content").innerHTML = `
            <h2>你的 KEY</h2>
            <div class="keybox">${key}</div>
            <p style="opacity:0.6">（已保存，24 小時內不需重新取得）</p>
        `;
        return;
    }

    let step = getStep();

    if (step === 1){
        document.getElementById("content").innerHTML = `
            <h2>Step 1</h2>
            <button class="btn"
                onclick="goStep2()">
                Continue
            </button>
        `;
        return;
    }

    if (step === 2){
        document.getElementById("content").innerHTML = `
            <h2>Step 2</h2>
            <button class="btn"
                onclick="goStep3()">
                Continue
            </button>
        `;
        return;
    }

    if (step >= 3){
        let newKey = "LB-" + Math.random().toString(36).substring(2,12).toUpperCase();
        saveKey(newKey);

        document.getElementById("content").innerHTML = `
            <h2>你的 KEY</h2>
            <div class="keybox">${newKey}</div>
            <p style="opacity:0.6">（已保存，下次免驗證）</p>
        `;
        return;
    }
}

// --------------------------------
// Step 按鈕處理（不靠 URL、不靠 referrer）
// --------------------------------

function goStep2(){
    setStep(2);
    location.href = "https://work.ink/26Yy/feairl-keysystem";
}

function goStep3(){
    setStep(3);
    location.href = "https://work.ink/26Yy/feairl-keysystem-1";
}

loadPage();
</script>

</body>
</html>
